{
  "title": "⚡ Task: Create domain events and event handlers",
  "body": "## ⚡ Domain Task - Event-Driven Architecture Implementation\n\n### Overview\nImplement a comprehensive domain events system and event handlers to enable event-driven architecture within the EduTrack domain layer.\n\n### Scope\nThis task establishes the foundation for domain events, enabling loose coupling between domain aggregates and supporting eventual consistency patterns.\n\n### Implementation Checklist\n\n#### Domain Events Infrastructure\n- [ ] Create `IDomainEvent` interface with common event properties\n- [ ] Implement `DomainEvent` base class with timestamp and correlation ID\n- [ ] Create `IDomainEventHandler<T>` interface for event handling\n- [ ] Implement `DomainEventDispatcher` for event publishing\n- [ ] Add domain event collection to `AggregateRoot<T>` base class\n- [ ] Create event publishing mechanism in `UnitOfWork`\n- [ ] Implement event store for audit and replay capabilities\n\n#### Student Domain Events\n- [ ] `StudentCreatedEvent` - When new student is registered\n- [ ] `StudentContactUpdatedEvent` - When contact information changes\n- [ ] `StudentEnrolledInCourseEvent` - When student enrolls in course\n- [ ] `StudentGradeAssignedEvent` - When grade is assigned to student\n- [ ] `StudentAttendanceMarkedEvent` - When attendance is recorded\n- [ ] `StudentGraduatedEvent` - When student completes program\n- [ ] `StudentSuspendedEvent` - When student status changes\n\n#### Course Domain Events\n- [ ] `CourseCreatedEvent` - When new course is created\n- [ ] `CourseCapacityChangedEvent` - When enrollment limits change\n- [ ] `CourseScheduleUpdatedEvent` - When course timing changes\n- [ ] `CourseAssignedToTeacherEvent` - When teacher is assigned\n- [ ] `CourseEnrollmentOpenedEvent` - When enrollment begins\n- [ ] `CourseEnrollmentClosedEvent` - When enrollment ends\n- [ ] `CourseCancelledEvent` - When course is cancelled\n\n#### Teacher Domain Events\n- [ ] `TeacherHiredEvent` - When new teacher joins\n- [ ] `TeacherAssignedToCourseEvent` - When course assignment made\n- [ ] `TeacherWorkloadUpdatedEvent` - When teaching load changes\n- [ ] `TeacherDepartmentChangedEvent` - When department transfer occurs\n- [ ] `TeacherQualificationAddedEvent` - When new qualification earned\n- [ ] `TeacherRetiredEvent` - When teacher leaves institution\n\n#### Academic Process Events\n- [ ] `SemesterStartedEvent` - When new academic term begins\n- [ ] `GradingPeriodOpenedEvent` - When grade submission opens\n- [ ] `AttendanceRequiredEvent` - When attendance tracking starts\n- [ ] `ExamScheduledEvent` - When examination is scheduled\n- [ ] `ResultPublishedEvent` - When results are made available\n\n#### Event Handlers Implementation\n- [ ] Create notification handlers for student events\n- [ ] Implement audit trail handlers for all events\n- [ ] Create integration event handlers for external systems\n- [ ] Implement email notification handlers\n- [ ] Create analytics event handlers for reporting\n- [ ] Implement workflow trigger handlers\n\n### Technical Implementation\n\n#### Domain Event Interface\n```csharp\npublic interface IDomainEvent\n{\n    Guid Id { get; }\n    DateTime OccurredOn { get; }\n    string CorrelationId { get; }\n    string EventType { get; }\n}\n\npublic abstract class DomainEvent : IDomainEvent\n{\n    public Guid Id { get; } = Guid.NewGuid();\n    public DateTime OccurredOn { get; } = DateTime.UtcNow;\n    public string CorrelationId { get; set; }\n    public virtual string EventType => GetType().Name;\n}\n```\n\n#### Event Handler Interface\n```csharp\npublic interface IDomainEventHandler<in T> where T : IDomainEvent\n{\n    Task HandleAsync(T domainEvent, CancellationToken cancellationToken = default);\n}\n```\n\n#### Example Domain Events\n```csharp\npublic class StudentCreatedEvent : DomainEvent\n{\n    public Guid StudentId { get; }\n    public string StudentNumber { get; }\n    public string FullName { get; }\n    public string Email { get; }\n    public DateTime DateOfBirth { get; }\n    \n    public StudentCreatedEvent(Guid studentId, string studentNumber, string fullName, string email, DateTime dateOfBirth)\n    {\n        StudentId = studentId;\n        StudentNumber = studentNumber;\n        FullName = fullName;\n        Email = email;\n        DateOfBirth = dateOfBirth;\n    }\n}\n\npublic class CourseAssignedToTeacherEvent : DomainEvent\n{\n    public Guid CourseId { get; }\n    public Guid TeacherId { get; }\n    public string CourseCode { get; }\n    public string TeacherName { get; }\n    public DateTime AssignmentDate { get; }\n    \n    public CourseAssignedToTeacherEvent(Guid courseId, Guid teacherId, string courseCode, string teacherName)\n    {\n        CourseId = courseId;\n        TeacherId = teacherId;\n        CourseCode = courseCode;\n        TeacherName = teacherName;\n        AssignmentDate = DateTime.UtcNow;\n    }\n}\n```\n\n#### Event Handler Examples\n```csharp\npublic class StudentCreatedEventHandler : IDomainEventHandler<StudentCreatedEvent>\n{\n    private readonly IEmailService _emailService;\n    private readonly ILogger<StudentCreatedEventHandler> _logger;\n    \n    public async Task HandleAsync(StudentCreatedEvent domainEvent, CancellationToken cancellationToken = default)\n    {\n        // Send welcome email\n        await _emailService.SendWelcomeEmailAsync(domainEvent.Email, domainEvent.FullName);\n        \n        // Log event\n        _logger.LogInformation(\"Student created: {StudentId} - {FullName}\", \n            domainEvent.StudentId, domainEvent.FullName);\n    }\n}\n```\n\n### Event Store Implementation\n- [ ] Create `IEventStore` interface for event persistence\n- [ ] Implement event store with EF Core\n- [ ] Add event versioning support\n- [ ] Create event replay capabilities\n- [ ] Implement event snapshots for performance\n- [ ] Add event stream querying\n\n### Testing Requirements\n- [ ] Unit tests for domain event creation\n- [ ] Unit tests for event handler execution\n- [ ] Integration tests for event publishing\n- [ ] Tests for event store persistence\n- [ ] Tests for event replay functionality\n- [ ] Performance tests for high-volume events\n\n### File Structure\n```\nsrc/EduTrack.Domain/\n├── Events/\n│   ├── IDomainEvent.cs\n│   ├── DomainEvent.cs\n│   ├── Student/\n│   │   ├── StudentCreatedEvent.cs\n│   │   ├── StudentEnrolledEvent.cs\n│   │   └── StudentGraduatedEvent.cs\n│   ├── Course/\n│   │   ├── CourseCreatedEvent.cs\n│   │   ├── CourseAssignedEvent.cs\n│   │   └── CourseScheduleUpdatedEvent.cs\n│   └── Teacher/\n│       ├── TeacherHiredEvent.cs\n│       ├── TeacherAssignedEvent.cs\n│       └── TeacherRetiredEvent.cs\n├── EventHandlers/\n│   ├── IDomainEventHandler.cs\n│   ├── Student/\n│   ├── Course/\n│   └── Teacher/\n└── Services/\n    ├── IDomainEventDispatcher.cs\n    ├── DomainEventDispatcher.cs\n    ├── IEventStore.cs\n    └── EventStore.cs\n```\n\n### Integration Points\n- [ ] MediatR integration for event dispatching\n- [ ] Integration with Application layer event handlers\n- [ ] Connection to Infrastructure email services\n- [ ] Integration with audit logging system\n- [ ] Connection to external system notifications\n\n### Acceptance Criteria\n- [ ] Domain events are raised when aggregate state changes\n- [ ] Event handlers execute reliably and asynchronously\n- [ ] Events are persisted for audit and replay\n- [ ] Event publishing is transactional with aggregate changes\n- [ ] Multiple handlers can subscribe to same event\n- [ ] Event versioning supports schema evolution\n- [ ] Performance meets requirements (>1000 events/second)\n- [ ] Error handling and retry policies implemented\n- [ ] Unit tests achieve >95% coverage\n- [ ] Integration tests verify end-to-end event flow\n\n### Dependencies\n- Depends on: Core domain entities (Course, Teacher)\n- Blocks: Application layer CQRS implementation\n- Integrates with: UnitOfWork pattern, MediatR\n\n### Estimated Effort\n**8-10 hours** (2-3 development sessions)\n\n### Definition of Done\n- [ ] All domain events defined and implemented\n- [ ] Event handlers created for core scenarios\n- [ ] Event store implemented and tested\n- [ ] Integration with aggregate roots completed\n- [ ] Unit and integration tests passing\n- [ ] Code review completed\n- [ ] Documentation includes event flow diagrams\n- [ ] Performance benchmarks meet requirements\n\n### Priority\n**High** - Enables event-driven architecture patterns",
  "labels": ["task", "domain-layer", "events", "architecture", "event-driven", "high-priority", "clean-architecture"],
  "assignees": ["mahedee"]
}
